<% if @comment.errors.empty? %>

    var post_comment_container;

    <% if @comment.parent %>

        var post_comment_parent = document.getElementById("post_comment_<%= @comment.parent.id %>");
        var post_comments_replies = post_comment_parent.querySelector('.post-comments-replies');
        
        if (!post_comments_replies) {
            post_comments_replies = document.createElement("ul");
            post_comments_replies.classList.add("post-comments-replies");

            post_comment_parent.append(post_comments_replies);
        }

        post_comment_container = post_comments_replies;

    <% else %>

        var post = document.getElementById("post-<%= @comment.commentable.id %>");
        var post_comments_wrapper = post.querySelector(".post-comments-wrapper");

        if (!post_comments_wrapper) {
            post_comments_wrapper = document.createElement("div");
            post_comments_wrapper.classList.add("post-comments-wrapper");

            var post_main_wrapper = post.querySelector('.post-main-wrapper');
            
            post_main_wrapper.after(post_comments_wrapper);
        }

        post_comment_container = post_comments_wrapper;

    <% end %>

    var post_comment = '<%= j render @comment %>';
    var post_comment_wrapper_div = document.createElement('div');

    post_comment_wrapper_div.innerHTML = post_comment;
    post_comment = post_comment_wrapper_div.firstChild;

    post_comment_container.prepend(post_comment);

<% else %>

<% end %>